<!doctype html>
<html lang="el">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Φοιτητική Ολιστική Συμπεριφορική Υποστήριξη</title>

  <meta name="description" content="Φοιτητική Ολιστική Συμπεριφορική Υποστήριξη. Αυτορρύθμιση, αναβολή, συγκέντρωση, ρύθμιση συναισθήματος, ανοχή δυσφορίας, κοινωνική στήριξη, στρατηγική μάθησης, ανάκαμψη και ύπνος. Προφίλ με cosine similarity και διάγραμμα αράχνη." />

  <style>
    :root{
      /* Colour psychology baseline.
         Blue = calm and trust.
         Teal = clarity and control.
         Green = progress and safety.
         Amber = attention.
         Red = error and stop.
      */
      --bg0:#06101a;
      --bg1:#0b1e2e;
      --card:rgba(255,255,255,.06);
      --line:rgba(255,255,255,.10);

      --text:#eef5ff;
      --muted:#b7c7df;

      --trust:#66a9ff;
      --calm:#2fd6c4;
      --safe:#34d399;
      --warn:#fbbf24;
      --danger:#fb7185;

      --shadow:0 16px 40px rgba(0,0,0,.35);
      --r:18px;
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }

    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Noto Sans", "Liberation Sans", sans-serif;
      color:var(--text);
      background:
        radial-gradient(1100px 700px at 10% 10%, rgba(102,169,255,.18) 0%, rgba(102,169,255,0) 55%),
        radial-gradient(900px 650px at 90% 15%, rgba(47,214,196,.16) 0%, rgba(47,214,196,0) 60%),
        radial-gradient(1000px 700px at 40% 90%, rgba(52,211,153,.12) 0%, rgba(52,211,153,0) 60%),
        linear-gradient(180deg, var(--bg1), var(--bg0));
    }

    .wrap{
      max-width:1180px;
      margin:0 auto;
      padding:18px 14px 60px;
    }

    .topbar{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:space-between;
      margin-bottom:12px;
    }

    .brand{
      display:flex;
      gap:10px;
      align-items:center;
    }

    .mark{
      width:38px;
      height:38px;
      border-radius:12px;
      background:
        radial-gradient(circle at 30% 30%, rgba(255,255,255,.35), rgba(255,255,255,0) 55%),
        linear-gradient(180deg, rgba(102,169,255,.55), rgba(47,214,196,.35));
      border:1px solid rgba(255,255,255,.14);
      box-shadow:0 10px 25px rgba(0,0,0,.25);
    }

    .brand h1{
      margin:0;
      font-size:18px;
      letter-spacing:.2px;
    }
    .brand p{
      margin:2px 0 0;
      font-size:12px;
      color:var(--muted);
      line-height:1.35;
    }

    .grid{
      display:grid;
      grid-template-columns: 1.15fr .85fr;
      gap:14px;
    }

    @media (max-width: 980px){
      .grid{ grid-template-columns: 1fr; }
    }

    .card{
      border-radius:var(--r);
      border:1px solid var(--line);
      background: linear-gradient(180deg, rgba(255,255,255,.07), rgba(255,255,255,.03));
      box-shadow:var(--shadow);
      padding:16px;
    }

    .card h2{
      margin:0 0 10px;
      font-size:16px;
      letter-spacing:.2px;
    }

    .lead{
      margin:0;
      color:var(--muted);
      font-size:14px;
      line-height:1.55;
    }

    .sep{
      height:1px;
      background: var(--line);
      margin:14px 0;
    }

    .pillRow{ display:flex; gap:8px; flex-wrap:wrap; margin-top:10px; }
    .pill{
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.14);
      color:var(--muted);
      padding:6px 10px;
      border-radius:999px;
      font-size:12px;
    }

    .row{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:12px;
    }
    @media (max-width: 720px){
      .row{ grid-template-columns: 1fr; }
    }

    label{
      display:block;
      font-size:12px;
      color:var(--muted);
      margin:0 0 6px;
    }

    input[type="text"], input[type="email"], textarea{
      width:100%;
      border-radius:14px;
      padding:10px 12px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.18);
      color: var(--text);
      outline:none;
    }

    textarea{
      min-height:92px;
      resize:vertical;
    }

    .consent{
      display:flex;
      gap:10px;
      align-items:flex-start;
      padding:10px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.14);
    }

    .consent input{ margin-top:2px; accent-color: var(--calm); }

    .btnbar{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      margin-top:12px;
    }

    .btn{
      cursor:pointer;
      border:none;
      border-radius:14px;
      padding:11px 14px;
      font-weight:800;
      letter-spacing:.2px;
      transition: transform .06s ease, filter .12s ease;
      user-select:none;
    }
    .btn:active{ transform: scale(.99); }

    .btn.primary{
      background: linear-gradient(180deg, rgba(102,169,255,.95), rgba(47,214,196,.70));
      color:#071524;
      box-shadow:0 14px 30px rgba(102,169,255,.20);
    }

    .btn.secondary{
      background: rgba(0,0,0,.16);
      border:1px solid rgba(255,255,255,.14);
      color:var(--text);
    }

    .btn.ghost{
      background: rgba(255,255,255,.06);
      border:1px dashed rgba(255,255,255,.18);
      color:var(--muted);
    }

    .hint{
      margin:10px 0 0;
      font-size:12px;
      color:var(--muted);
      line-height:1.45;
    }

    .progressBox{
      display:flex;
      gap:10px;
      align-items:center;
      justify-content:space-between;
      padding:10px 12px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.14);
    }

    .progressMeta{
      min-width:170px;
    }

    .progressMeta b{
      display:block;
      font-size:13px;
    }

    .progressMeta span{
      display:block;
      font-size:12px;
      color:var(--muted);
      margin-top:4px;
    }

    .progress{
      width:100%;
      height:10px;
      border-radius:999px;
      background: rgba(255,255,255,.08);
      overflow:hidden;
    }

    .bar{
      height:100%;
      width:0%;
      background: linear-gradient(90deg, rgba(251,191,36,.95), rgba(52,211,153,.95));
      box-shadow:0 0 0 rgba(0,0,0,0);
      transition: width .2s ease;
    }

    .navMini{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      margin-top:10px;
    }

    .chip{
      cursor:pointer;
      padding:7px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.14);
      color:var(--muted);
      font-size:12px;
      transition: filter .12s ease, transform .06s ease;
      user-select:none;
    }
    .chip:hover{ filter: brightness(1.08); }
    .chip:active{ transform: scale(.99); }

    .qCard{ display:none; }
    .resultsCard{ display:none; }

    details.section{
      margin-top:12px;
      border-radius:16px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.14);
      overflow:hidden;
    }

    summary.sectionHead{
      cursor:pointer;
      padding:12px 12px;
      list-style:none;
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:10px;
      user-select:none;
    }
    summary.sectionHead::-webkit-details-marker{ display:none; }

    .secTitle{
      display:block;
      font-weight:900;
      font-size:13px;
      letter-spacing:.2px;
    }

    .secDesc{
      display:block;
      font-size:12px;
      color:var(--muted);
      margin-top:4px;
      line-height:1.35;
    }

    .secCount{
      font-size:12px;
      color:var(--muted);
      white-space:nowrap;
      padding-top:2px;
    }

    .secBody{
      padding:0 12px 12px;
    }

    .qItem{
      margin-top:10px;
      padding:12px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.14);
      position:relative;
      scroll-margin-top: 18px;
    }

    .qText{
      margin:0 0 10px;
      font-size:13px;
      line-height:1.4;
    }

    .scale{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      align-items:center;
    }

    .opt{
      display:flex;
      gap:6px;
      align-items:center;
      padding:8px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.10);
      cursor:pointer;
      user-select:none;
      transition: filter .12s ease;
    }
    .opt:hover{ filter: brightness(1.08); }
    .scale input{ accent-color: var(--trust); }

    .focusRing{
      outline: 3px solid rgba(251,113,133,.55);
      box-shadow: 0 0 0 6px rgba(251,113,133,.12);
    }

    .shake{
      animation: shake .28s ease-in-out 0s 2;
    }
    @keyframes shake{
      0%{ transform: translateX(0); }
      25%{ transform: translateX(-4px); }
      50%{ transform: translateX(4px); }
      75%{ transform: translateX(-3px); }
      100%{ transform: translateX(0); }
    }

    .badgeRow{ display:flex; gap:8px; flex-wrap:wrap; margin-top:8px; }
    .badge{
      display:inline-block;
      padding:6px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.12);
      font-size:12px;
      color:var(--muted);
    }

    .radarWrap{
      border-radius:16px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.14);
      padding:12px;
    }

    canvas{
      width:100%;
      height:auto;
      max-height:420px;
      display:block;
    }

    .kpi{
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap:10px;
      margin-top:10px;
    }
    @media (max-width: 980px){
      .kpi{ grid-template-columns: 1fr; }
    }

    .kpi .box{
      border:1px solid rgba(255,255,255,.14);
      border-radius:16px;
      background: rgba(0,0,0,.12);
      padding:10px;
    }
    .kpi .box b{ display:block; font-size:13px; margin-bottom:6px; }
    .kpi .box span{ display:block; font-size:12px; color:var(--muted); line-height:1.35; }

    .mono{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size:12px;
      color:var(--muted);
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="topbar">
      <div class="brand">
        <div class="mark" aria-hidden="true"></div>
        <div>
          <h1>Φοιτητική Ολιστική Συμπεριφορική Υποστήριξη</h1>
          <p>Συμπλήρωση αξιολόγησης δεξιοτήτων, παραγωγή προφίλ, και δημιουργία αναφοράς με διάγραμμα αράχνη.</p>
        </div>
      </div>

      <div class="btnbar" style="margin:0;">
        <button class="btn ghost" id="saveBtn" type="button">Αποθήκευση προόδου</button>
        <button class="btn ghost" id="loadBtn" type="button">Φόρτωση προόδου</button>
        <button class="btn secondary" id="resetBtn" type="button">Καθαρισμός</button>
      </div>
    </div>

    <div class="grid">
      <div>
        <div class="card">
          <h2>Τι θα κερδίσεις με τη συμπλήρωση</h2>
          <p class="lead">
            Προσοχή. Όταν η πίεση ανεβαίνει, μικρές αστοχίες γίνονται μεγάλα κόστη.  
            Ενδιαφέρον. Αυτή η αξιολόγηση χαρτογραφεί τις δεξιότητες που ρυθμίζουν συγκέντρωση, ρυθμό και αντοχή.  
            Επιθυμία. Θα δεις ένα καθαρό προφίλ, με άμεση ερμηνεία και πρακτικά βήματα.  
            Δράση. Συμπλήρωσε, πάρε αναφορά, και στείλε την στον Δρ Χιώνη.
          </p>
          <div class="pillRow">
            <span class="pill">συγκέντρωση</span>
            <span class="pill">αναβολή</span>
            <span class="pill">άγχος εξετάσεων</span>
            <span class="pill">ύπνος</span>
            <span class="pill">ανθεκτικότητα</span>
            <span class="pill">στρατηγικές μάθησης</span>
          </div>

          <div class="sep"></div>

          <p class="lead">
            Η αξιολόγηση είναι για ολιστική συμπεριφορική υποστήριξη.  
            Η αξιολόγηση δεν είναι ψυχιατρική διάγνωση.  
            Η αξιολόγηση δείχνει προτεραιότητες και επόμενα βήματα.
          </p>
        </div>

        <div class="card" style="margin-top:14px;">
          <h2>Στοιχεία για την αναφορά</h2>
          <div class="row">
            <div>
              <label for="name">Ονοματεπώνυμο</label>
              <input id="name" type="text" placeholder="π.χ. Μαρία Παπαδοπούλου" autocomplete="name" />
            </div>
            <div>
              <label for="email">Email</label>
              <input id="email" type="email" placeholder="π.χ. maria@email.com" autocomplete="email" />
            </div>
          </div>

          <div class="row" style="margin-top:12px;">
            <div>
              <label for="school">Τμήμα ή Σχολή</label>
              <input id="school" type="text" placeholder="π.χ. Ψυχολογία" />
            </div>
            <div>
              <label for="goal">Στόχος 4 εβδομάδων</label>
              <input id="goal" type="text" placeholder="π.χ. σταθερός ρυθμός μελέτης και ύπνου" />
            </div>
          </div>

          <div style="margin-top:12px;">
            <label for="notes">Σημειώσεις που θέλεις να ληφθούν υπόψη</label>
            <textarea id="notes" placeholder="π.χ. δυσκολία εκκίνησης, έντονο άγχος πριν εξετάσεις, διάσπαση"></textarea>
          </div>

          <div class="sep"></div>

          <div class="consent">
            <input id="consent" type="checkbox" />
            <div>
              <div style="font-weight:900;">Συναίνεση</div>
              <div class="hint" style="margin:6px 0 0;">
                Συμπληρώνεις εθελοντικά.  
                Κατανοείς ότι το αποτέλεσμα αφορά ολιστική συμπεριφορική υποστήριξη.  
                Κατανοείς ότι δεν πρόκειται για κλινική διάγνωση.
              </div>
            </div>
          </div>

          <div class="btnbar">
            <button class="btn primary" id="startBtn" type="button">Ξεκίνα το ερωτηματολόγιο</button>
            <button class="btn secondary" id="calcBtnTop" type="button">Υπολογισμός προφίλ</button>
            <button class="btn secondary" id="toTopBtn" type="button">Πάνω</button>
          </div>

          <p class="hint">
            Στο τέλος θα κατέβει αναφορά Word.  
            Μετά θα ανοίξει email προς dchionis10@gmail.com.  
            Θα επισυνάψεις την αναφορά και θα τη στείλεις.
          </p>
        </div>

        <div class="card qCard" id="qCard" style="margin-top:14px;">
          <h2>Ερωτηματολόγιο</h2>

          <div class="progressBox">
            <div class="progressMeta">
              <b>Πρόοδος</b>
              <span id="progressText">0 από 0</span>
            </div>
            <div class="progress" aria-hidden="true">
              <div class="bar" id="progressBar"></div>
            </div>
          </div>

          <div class="hint">
            Κλίμακα. 1 διαφωνώ απόλυτα. 2 διαφωνώ. 3 ούτε ούτε. 4 συμφωνώ. 5 συμφωνώ απόλυτα.
          </div>

          <div class="navMini" id="navMini"></div>

          <div id="sections"></div>

          <div class="btnbar">
            <button class="btn primary" id="calcBtn" type="button">Υπολογισμός προφίλ</button>
            <button class="btn secondary" id="finishBtn" type="button">Ολοκλήρωση</button>
          </div>

          <p class="hint">
            Αν λείπει απάντηση, θα μεταφερθείς αυτόματα στο πρώτο σημείο που χρειάζεται συμπλήρωση.
          </p>
        </div>

        <div class="card resultsCard" id="resultsCard" style="margin-top:14px;">
          <h2>Αποτελέσματα</h2>

          <div class="radarWrap" id="profileBox"></div>

          <div class="sep"></div>

          <div class="radarWrap">
            <div style="font-weight:900; font-size:13px;">Διάγραμμα αράχνη</div>
            <div class="hint" style="margin-top:6px;">
              Το διάγραμμα δείχνει το σχήμα του προφίλ.  
              Το σχήμα σημαίνει προτεραιότητες για συμπεριφορική ενίσχυση.
            </div>
            <canvas id="radar" width="900" height="520"></canvas>
            <div class="hint" id="radarNote" style="margin-top:8px;"></div>
          </div>

          <div class="sep"></div>

          <div class="btnbar">
            <button class="btn primary" id="downloadBtn" type="button">Λήψη αναφοράς Word</button>
            <button class="btn secondary" id="emailBtn" type="button">Άνοιγμα email</button>
          </div>

          <p class="hint">
            Στο email θα επισυνάψεις το αρχείο Word που κατέβηκε.  
            Έπειτα θα το στείλεις στον Δρ Χιώνη.
          </p>
        </div>
      </div>

      <div>
        <div class="card">
          <h2>Πώς προκύπτει το προφίλ</h2>
          <p class="lead">
            Οι απαντήσεις σχηματίζουν διάνυσμα δεξιοτήτων.  
            Το διάνυσμα συγκρίνεται με προφίλ στόχου.  
            Η σύγκριση γίνεται με cosine similarity και δίνει το κοντινότερο μοτίβο.
          </p>

          <div class="sep"></div>

          <p class="lead">
            Το αποτέλεσμα είναι χάρτης δεξιοτήτων.  
            Το αποτέλεσμα δεν είναι διάγνωση.  
            Το αποτέλεσμα οδηγεί σε πρακτικά βήματα υποστήριξης.
          </p>
        </div>

        <div class="card" style="margin-top:14px;">
          <h2>Ασφάλεια και όρια</h2>
          <p class="lead">
            Αν υπάρχουν έντονα συμπτώματα ή κίνδυνος, χρειάζεται κλινική εκτίμηση.  
            Αν νιώθεις ότι δεν είσαι ασφαλής, ζήτησε άμεση βοήθεια από υπηρεσίες υγείας.
          </p>
          <div class="sep"></div>
          <p class="hint">
            Το εργαλείο είναι αυτοαναφορά.  
            Το εργαλείο υποστηρίζει συμπεριφορική στοχοθεσία.
          </p>
        </div>

        <div class="card" style="margin-top:14px;">
          <h2>Τεχνική σημείωση</h2>
          <p class="lead">
            Η αναφορά δημιουργείται τοπικά στον browser.  
            Το email ανοίγει για να γίνει χειροκίνητη επισύναψη.  
            Αυτό μειώνει έκθεση δεδομένων σε τρίτους.
          </p>
        </div>
      </div>
    </div>
  </div>

<script>
  const EMAIL_TO = "dchionis10@gmail.com";

  const LIKERT = [
    { v: 1, t: "1 διαφωνώ απόλυτα" },
    { v: 2, t: "2 διαφωνώ" },
    { v: 3, t: "3 ούτε ούτε" },
    { v: 4, t: "4 συμφωνώ" },
    { v: 5, t: "5 συμφωνώ απόλυτα" }
  ];

  const DIMENSIONS = [
    {
      id: "init",
      name: "Εκκίνηση και αυτορρύθμιση",
      desc: "Ξεκίνημα, συνέπεια, αναβολή, μικρά βήματα.",
      items: [
        "Ξεκινώ τη μελέτη μέσα σε λίγα λεπτά, όταν έχω πλάνο.",
        "Αν κολλήσω, συνεχίζω με το επόμενο μικρό βήμα.",
        "Αφήνω το κινητό εκτός οπτικού πεδίου, όταν διαβάζω.",
        "Κλείνω ειδοποιήσεις, πριν ξεκινήσω.",
        "Αν χάσω μία μέρα, επιστρέφω χωρίς να το κάνω δράμα.",
        "Σπάω μεγάλα tasks σε μικρές ενέργειες.",
        "Ξεκινώ πρώτα τα δύσκολα, όταν χρειάζεται.",
        "Δεν περιμένω να νιώσω έτοιμος ή έτοιμη για να ξεκινήσω.",
        "Όταν έχω άγχος, μπορώ να ξεκινήσω έστω και λίγο.",
        "Τηρώ ένα βασικό πρόγραμμα, ακόμη και σε πίεση.",
        "Αποφεύγω το scrolling πριν τη μελέτη.",
        "Βάζω χρονόμετρο και το ακολουθώ.",
        "Κάνω διάλειμμα χωρίς να χάνω τον έλεγχο χρόνου.",
        "Επιστρέφω στη δουλειά μετά το διάλειμμα.",
        "Ορίζω τι σημαίνει ολοκλήρωση για κάθε εργασία.",
        "Κάνω μικρή προθέρμανση 2 λεπτών και μπαίνω στο task.",
        "Όταν βαριέμαι, συνεχίζω για άλλα 5 λεπτά.",
        "Η αναβολή δεν μου τρώει το μεγαλύτερο κομμάτι της εβδομάδας.",
        "Κάνω έλεγχο προόδου στο τέλος της ημέρας.",
        "Αποφεύγω να ξεκινάω πολλά πράγματα μαζί."
      ]
    },
    {
      id: "goals",
      name: "Στόχοι και μικροδεσμεύσεις",
      desc: "Σαφήνεια στόχου, συγκεκριμενοποίηση, συνέπεια.",
      items: [
        "Γράφω τι θέλω να πετύχω πριν αρχίσω να δουλεύω.",
        "Μπορώ να πω σε μία πρόταση τον στόχο της εβδομάδας.",
        "Μετατρέπω τον στόχο σε μικρές καθημερινές πράξεις.",
        "Ξέρω πότε ένα task είναι αρκετά καλό για να κλείσει.",
        "Έχω ξεκάθαρο ορισμό επιτυχίας για το διάβασμα.",
        "Αν αλλάξει κάτι, προσαρμόζω στόχο χωρίς να τα παρατήσω.",
        "Βάζω ρεαλιστικό φόρτο.",
        "Χρησιμοποιώ λίστα ενεργειών.",
        "Ξέρω τι είναι προτεραιότητα σήμερα.",
        "Δεν μπερδεύω το άγχος με στόχο.",
        "Όταν πέσω έξω, αναθεωρώ και συνεχίζω.",
        "Ορίζω πότε θα ξεκινήσω και πού θα το κάνω.",
        "Ορίζω πότε θα σταματήσω για να προστατέψω ύπνο.",
        "Κάνω εβδομαδιαία ανασκόπηση, έστω και μικρή.",
        "Μετράω χρόνο εστίασης, όχι μόνο ώρες στο γραφείο.",
        "Αν χάσω μία δέσμευση, επιστρέφω την επόμενη.",
        "Επιβραβεύω τη διαδικασία, όχι μόνο το αποτέλεσμα.",
        "Θέτω στόχους που με τραβάνε, όχι μόνο που με φοβίζουν.",
        "Έχω plan B όταν η μέρα στραβώσει.",
        "Δεν γεμίζω τη μέρα με στόχους που δεν χωράνε."
      ]
    },
    {
      id: "focus",
      name: "Προσοχή και εκτελεστικός έλεγχος",
      desc: "Διάσπαση, επιμονή, επαναφορά, παρόρμηση.",
      items: [
        "Μένω σε ένα task χωρίς να πηδάω σε άλλα κάθε λίγο.",
        "Όταν αποσπαστώ, επιστρέφω σχετικά γρήγορα.",
        "Δεν αλλάζω εφαρμογή χωρίς λόγο, όταν δουλεύω.",
        "Αν νιώσω παρόρμηση να ελέγξω κάτι, μπορώ να περιμένω.",
        "Μπορώ να διαβάσω 25 λεπτά χωρίς διακοπή.",
        "Μπορώ να κάνω 2 κύκλους εστίασης στη σειρά.",
        "Συνήθως θυμάμαι τι έκανα πριν διακοπώ.",
        "Δεν χάνω πολύ χρόνο για να ξαναβρώ το νήμα.",
        "Οργανώνω υλικά πριν ξεκινήσω.",
        "Αποφεύγω να ανοίγω πολλά tabs μαζί.",
        "Κλείνω ειδοποιήσεις σε βαθιά δουλειά.",
        "Κρατάω μία σκέψη σε εκκρεμότητα χωρίς να τη λύσω τώρα.",
        "Όταν νιώθω ανησυχία, δεν με τραβά από το task αμέσως.",
        "Δεν με ρίχνουν εύκολα εξωτερικοί θόρυβοι.",
        "Ακολουθώ οδηγίες χωρίς να χάνω βήματα.",
        "Ελέγχω παρορμήσεις φαγητού ή καφέ όταν διαβάζω.",
        "Κάνω δύσκολο μέρος χωρίς να το αναβάλλω αυτόματα.",
        "Αντέχω βαρετά κομμάτια ύλης.",
        "Όταν κάνω λάθος, δεν χάνω όλη τη ροή.",
        "Ολοκληρώνω αυτό που άρχισα."
      ]
    },
    {
      id: "er",
      name: "Ρύθμιση συναισθήματος",
      desc: "Αναπλαισίωση, έλεγχος έντασης, ψυχραιμία.",
      items: [
        "Βλέπω μία δυσκολία σαν πρόβλημα προς λύση.",
        "Αλλάζω οπτική όταν αγχώνομαι.",
        "Όταν αποτύχω, δεν το κάνω ταυτότητα.",
        "Δεν με παίρνει εύκολα η καταστροφολογία.",
        "Ηρεμώ με απλή αναπνοή.",
        "Ηρεμώ με κίνηση ή περπάτημα.",
        "Δεν ξεσπάω εύκολα σε ανθρώπους γύρω μου.",
        "Όταν θυμώσω, δεν κάνω παρορμητικές κινήσεις.",
        "Μιλάω στον εαυτό μου με πιο δίκαιο τρόπο.",
        "Δεν χρησιμοποιώ το άγχος σαν καύσιμο μέχρι εξάντληση.",
        "Σε πίεση κρατάω αξιοπρέπεια.",
        "Κάνω παύση πριν απαντήσω σε ένταση.",
        "Αντέχω λίγο άγχος και συνεχίζω.",
        "Δεν χρειάζομαι τέλειες συνθήκες για να λειτουργήσω.",
        "Ξεχωρίζω γεγονός από ερμηνεία.",
        "Βάζω όρια στο εσωτερικό drama.",
        "Ο φόβος δεν με ακινητοποιεί εντελώς.",
        "Μετατρέπω το άγχος σε σχέδιο.",
        "Ρυθμίζω ρυθμό σε εξετάσεις.",
        "Επανέρχομαι μετά από έντονο συναίσθημα."
      ]
    },
    {
      id: "dt",
      name: "Ανοχή δυσφορίας και ευελιξία",
      desc: "Αντοχή, αποφυγή, επιλογή πράξης, αξίες.",
      items: [
        "Συνεχίζω σε task, ακόμη και αν δεν νιώθω καλά.",
        "Δεν χρειάζεται να φύγει η δυσφορία για να δράσω.",
        "Όταν κάτι είναι άβολο, δεν το αποφεύγω πάντα.",
        "Αν φοβηθώ, δεν ακυρώνω όλη τη μέρα μου.",
        "Αντέχω την αβεβαιότητα για λίγο.",
        "Αντέχω τη βαρεμάρα χωρίς να αποδράσω.",
        "Αντέχω κριτική χωρίς να σπάσω.",
        "Κάνω έκθεση σε δύσκολα κομμάτια ύλης.",
        "Μένω σε αξίες μου όταν πιέζομαι.",
        "Δεν χρειάζεται αυτοπεποίθηση για να ξεκινήσω.",
        "Αφήνω μία σκέψη να περάσει χωρίς να τη λύσω.",
        "Δεν παγώνω εύκολα σε απαιτήσεις.",
        "Επιλέγω πράξη αντί για παρόρμηση.",
        "Δεν χρησιμοποιώ πάντα αποφυγή για να νιώσω καλύτερα.",
        "Αποδέχομαι μικρές ατέλειες και προχωράω.",
        "Συνεχίζω παρά την εσωτερική γκρίνια.",
        "Κάνω το πρώτο βήμα και ας μην είμαι έτοιμος ή έτοιμη.",
        "Μένω στο παρόν όταν αγχώνομαι.",
        "Λειτουργώ χωρίς να με ελέγχει η διάθεση.",
        "Ξανασηκώνομαι μετά από setback."
      ]
    },
    {
      id: "ss",
      name: "Κοινωνική στήριξη και ανήκειν",
      desc: "Αίσθηση στήριξης, σύνδεση, ασφάλεια.",
      items: [
        "Έχω τουλάχιστον ένα άτομο που με στηρίζει στα δύσκολα.",
        "Αν ζητήσω βοήθεια, δεν θα με κρίνουν υπερβολικά.",
        "Νιώθω ότι ανήκω κάπου.",
        "Έχω ανθρώπους που με καταλαβαίνουν, έστω και λίγο.",
        "Μιλάω για άγχος χωρίς ντροπή.",
        "Μοιράζομαι αποτυχία χωρίς να γελοιοποιηθώ.",
        "Έχω ένα άτομο για επείγουσα υποστήριξη.",
        "Δεν νιώθω μόνος ή μόνη στις εξετάσεις.",
        "Έχω σχέση εμπιστοσύνης με μέντορα ή διδάσκοντα.",
        "Δέχομαι στήριξη χωρίς να νιώθω αδυναμία.",
        "Κρατάω επαφή με φίλους, ακόμη και σε φόρτο.",
        "Δεν απομονώνομαι όταν δυσκολεύομαι.",
        "Νιώθω ότι αξίζω στήριξη.",
        "Οι γύρω μου δεν με μικραίνουν.",
        "Έχω κύκλο που σέβεται τα όρια μου.",
        "Ζητάω πρακτική βοήθεια όταν χρειάζεται.",
        "Λέω όχι χωρίς υπερβολικό φόβο απόρριψης.",
        "Έχω εμπειρίες συνεργασίας που λειτουργούν.",
        "Ζητάω feedback χωρίς υπερβολικό φόβο.",
        "Υπάρχει ένα ασφαλές σημείο για μένα."
      ]
    },
    {
      id: "hs",
      name: "Ζήτηση βοήθειας και στρατηγική μάθησης",
      desc: "Πότε ζητάς βοήθεια, πώς μαθαίνεις, πώς δουλεύεις με feedback.",
      items: [
        "Ζητάω βοήθεια πριν γίνει κρίση.",
        "Ξέρω σε ποιον να πάω για κάθε είδος θέματος.",
        "Κάνω σωστή ερώτηση για ύλη.",
        "Ζητάω διευκρίνιση χωρίς να νιώθω μικρός ή μικρή.",
        "Ζητάω παράδειγμα, όταν δεν καταλαβαίνω.",
        "Κάνω ενεργητική ανάκληση, όχι μόνο διάβασμα με μάτια.",
        "Κάνω μικρά τεστ στον εαυτό μου.",
        "Χρησιμοποιώ σημειώσεις με τρόπο που με βοηθά.",
        "Όταν δεν καταλαβαίνω, το πιάνω από την αρχή.",
        "Αλλάζω στρατηγική όταν δεν δουλεύει.",
        "Ζητάω feedback και το εφαρμόζω.",
        "Δεν περιμένω την τελευταία εβδομάδα για να φανεί κενό.",
        "Ορίζω τι δεν ξέρω και το στοχεύω.",
        "Κάνω ανασκόπηση λαθών μετά από τεστ ή quiz.",
        "Φτιάχνω απλό πλάνο εξεταστικής.",
        "Δίν誘 χρόνο σε δύσκολα κεφάλαια.",
        "Χρησιμοποιώ υποστήριξη όταν χρειάζεται.",
        "Ξέρω να χρησιμοποιώ πηγές με σωστό τρόπο.",
        "Φτιάχνω ρεαλιστικό πρόγραμμα επανάληψης.",
        "Κρατάω στρατηγική σε πίεση."
      ]
    },
    {
      id: "rec",
      name: "Ανάκαμψη και ύπνος",
      desc: "Ύπνος, αποσύνδεση, ενέργεια, σταθερότητα.",
      items: [
        "Κρατάω σχετικά σταθερή ώρα ύπνου.",
        "Κρατάω σχετικά σταθερή ώρα αφύπνισης.",
        "Κοιμάμαι χωρίς πολύ scrolling πριν.",
        "Αποφεύγω καφέ αργά που χαλά ύπνο.",
        "Κάνω μικρή αποσύνδεση πριν κοιμηθώ.",
        "Ο ύπνος μου συνήθως με ξεκουράζει.",
        "Αν χάσω ύπνο, το διορθώνω την επόμενη μέρα.",
        "Κάνω διάλειμμα που με φορτίζει.",
        "Κάνω κίνηση ή άσκηση έστω και λίγο.",
        "Έχω μικρές στιγμές χαλάρωσης μέσα στη μέρα.",
        "Αποσυνδέομαι από σκέψεις για μελέτη.",
        "Δεν με κυνηγά ενοχή όταν ξεκουράζομαι.",
        "Κάνω πράγματα που δίνουν νόημα εκτός σχολής.",
        "Δεν πάω συνεχόμενα στο κόκκινο.",
        "Βρίσκω τρόπο να επανέλθω μετά από φόρτο.",
        "Κοιμάμαι χωρίς να σκέφτομαι συνέχεια ύλη.",
        "Δεν έχω συχνά αϋπνία πριν από υποχρεώσεις.",
        "Κάνω power nap χωρίς να χαλάσει η νύχτα.",
        "Έχω ρουτίνα που προστατεύει ενέργεια.",
        "Επιστρέφω σε baseline μετά από δύσκολη εβδομάδα."
      ]
    }
  ];

  const TARGET_PROFILES = [
    {
      id: "P1",
      name: "Σταθερή Βάση",
      tagline: "Χτίσιμο ρυθμού και βασικών κανόνων.",
      vector: [0.55,0.52,0.50,0.52,0.50,0.55,0.52,0.58],
      focus: [
        "Σταθεροποίηση ύπνου και ενέργειας.",
        "Μικρά blocks εστίασης με κανόνα έναρξης.",
        "Απλή εβδομαδιαία ανασκόπηση."
      ]
    },
    {
      id: "P2",
      name: "Ακαδημαϊκή Επιτάχυνση",
      tagline: "Εστίαση, στρατηγική μάθησης, συνέπεια.",
      vector: [0.70,0.72,0.74,0.58,0.55,0.60,0.74,0.62],
      focus: [
        "Βαθιά δουλειά σε σταθερά blocks.",
        "Active recall και έλεγχος λαθών.",
        "Διαχείριση φόρτου με καθαρές προτεραιότητες."
      ]
    },
    {
      id: "P3",
      name: "Υπερφόρτωση και Ρύθμιση",
      tagline: "Πρώτα ρύθμιση έντασης και ανοχή δυσφορίας.",
      vector: [0.55,0.55,0.55,0.38,0.38,0.50,0.52,0.55],
      focus: [
        "Μείωση καταστροφολογίας με αναπλαισίωση.",
        "Παύση πριν από αντιδράσεις.",
        "Μικρές εκθέσεις σε δύσκολα κομμάτια."
      ]
    },
    {
      id: "P4",
      name: "Μοναχικός Μαχητής",
      tagline: "Ενίσχυση στήριξης και έγκαιρης βοήθειας.",
      vector: [0.58,0.58,0.60,0.55,0.55,0.30,0.35,0.55],
      focus: [
        "Χτίσιμο ασφαλούς δικτύου στήριξης.",
        "Scripts για ζήτηση βοήθειας.",
        "Σταθερό feedback loop."
      ]
    },
    {
      id: "P5",
      name: "Ικανός αλλά Ανοργάνωτος",
      tagline: "Στόχοι και εκκίνηση, χωρίς υπερφόρτωση.",
      vector: [0.35,0.38,0.55,0.55,0.55,0.55,0.58,0.55],
      focus: [
        "Κανόνας έναρξης σε 2 λεπτά.",
        "If then μικροπλάνο.",
        "Λιγότερα tasks, πιο καθαρό κλείσιμο."
      ]
    },
    {
      id: "P6",
      name: "Υψηλή Απόδοση με Χαμηλή Ανάκαμψη",
      tagline: "Προστασία ύπνου και αποφόρτιση για να κρατήσει.",
      vector: [0.70,0.72,0.70,0.62,0.58,0.55,0.70,0.35],
      focus: [
        "Ρουτίνα αποσύνδεσης πριν τη νύχτα.",
        "Όρια οθόνης και φόρτου.",
        "Ανάκτηση ενέργειας με σταθερότητα."
      ]
    }
  ];

  function $(id){ return document.getElementById(id); }

  const qCard = $("qCard");
  const resultsCard = $("resultsCard");
  const sectionsEl = $("sections");
  const navMini = $("navMini");

  const progressText = $("progressText");
  const progressBar = $("progressBar");

  const startBtn = $("startBtn");
  const calcBtn = $("calcBtn");
  const calcBtnTop = $("calcBtnTop");
  const finishBtn = $("finishBtn");
  const toTopBtn = $("toTopBtn");

  const downloadBtn = $("downloadBtn");
  const emailBtn = $("emailBtn");

  const saveBtn = $("saveBtn");
  const loadBtn = $("loadBtn");
  const resetBtn = $("resetBtn");

  const profileBox = $("profileBox");
  const radar = $("radar");
  const radarNote = $("radarNote");

  let totalItems = 0;
  let lastComputed = null;

  function requireConsent(){
    if(!$("consent").checked){
      alert("Χρειάζεται συναίνεση για να συνεχίσεις.");
      return false;
    }
    return true;
  }

  function getMeta(){
    return {
      name: $("name").value.trim(),
      email: $("email").value.trim(),
      school: $("school").value.trim(),
      goal: $("goal").value.trim(),
      notes: $("notes").value.trim(),
      date: new Date().toLocaleString("el-GR")
    };
  }

  function buildNavChip(label, targetId){
    const c = document.createElement("button");
    c.type = "button";
    c.className = "chip";
    c.textContent = label;
    c.addEventListener("click", () => {
      const el = document.getElementById(targetId);
      if(el){
        el.open = true;
        el.scrollIntoView({ behavior:"smooth", block:"start" });
      }
    });
    return c;
  }

  function buildQuestionnaire(){
    sectionsEl.innerHTML = "";
    navMini.innerHTML = "";
    totalItems = 0;

    DIMENSIONS.forEach((d) => {
      const sec = document.createElement("details");
      sec.className = "section";
      sec.id = `sec_${d.id}`;
      sec.open = false;

      const sum = document.createElement("summary");
      sum.className = "sectionHead";

      const left = document.createElement("div");
      const t = document.createElement("span");
      t.className = "secTitle";
      t.textContent = d.name;
      const ds = document.createElement("span");
      ds.className = "secDesc";
      ds.textContent = d.desc;
      left.appendChild(t);
      left.appendChild(ds);

      const right = document.createElement("div");
      right.className = "secCount";
      right.textContent = `${d.items.length} items`;

      sum.appendChild(left);
      sum.appendChild(right);
      sec.appendChild(sum);

      const body = document.createElement("div");
      body.className = "secBody";

      d.items.forEach((it, ix) => {
        const q = document.createElement("div");
        q.className = "qItem";
        q.dataset.group = `q_${d.id}_${ix}`;

        const p = document.createElement("p");
        p.className = "qText";
        p.textContent = `${totalItems + 1}. ${it}`;
        q.appendChild(p);

        const scale = document.createElement("div");
        scale.className = "scale";

        LIKERT.forEach(opt => {
          const lb = document.createElement("label");
          lb.className = "opt";

          const inp = document.createElement("input");
          inp.type = "radio";
          inp.name = `q_${d.id}_${ix}`;
          inp.value = String(opt.v);
          inp.addEventListener("change", () => {
            clearItemError(q);
            updateProgress();
            autosaveLight();
          });

          const sp = document.createElement("span");
          sp.textContent = String(opt.v);

          lb.appendChild(inp);
          lb.appendChild(sp);
          scale.appendChild(lb);
        });

        q.appendChild(scale);
        body.appendChild(q);
        totalItems += 1;
      });

      sec.appendChild(body);
      sectionsEl.appendChild(sec);

      navMini.appendChild(buildNavChip(d.name, sec.id));
    });

    if(DIMENSIONS[0]){
      const first = document.getElementById(`sec_${DIMENSIONS[0].id}`);
      if(first) first.open = true;
    }

    updateProgress();
  }

  function updateProgress(){
    const answered = document.querySelectorAll('input[type="radio"]:checked').length;
    progressText.textContent = `${answered} από ${totalItems}`;
    const pct = totalItems ? Math.round((answered / totalItems) * 100) : 0;
    progressBar.style.width = pct + "%";
  }

  function findFirstUnanswered(){
    for(const d of DIMENSIONS){
      for(let ix=0; ix<d.items.length; ix++){
        const name = `q_${d.id}_${ix}`;
        const checked = document.querySelector(`input[name="${name}"]:checked`);
        if(!checked){
          const groupEl = document.querySelector(`.qItem[data-group="${name}"]`);
          return { dimId:d.id, ix, name, el: groupEl };
        }
      }
    }
    return null;
  }

  function markItemError(qEl){
    if(!qEl) return;
    qEl.classList.add("focusRing");
    qEl.classList.add("shake");
    setTimeout(() => qEl.classList.remove("shake"), 800);
  }

  function clearItemError(qEl){
    if(!qEl) return;
    qEl.classList.remove("focusRing");
  }

  function scrollToUnanswered(info){
    if(!info || !info.el) return;
    const sec = document.getElementById(`sec_${info.dimId}`);
    if(sec) sec.open = true;
    info.el.scrollIntoView({ behavior:"smooth", block:"center" });
    markItemError(info.el);
  }

  function computeDimensionScores(){
    const scores = [];
    const raw = [];

    for(const d of DIMENSIONS){
      let sum = 0;
      let count = 0;
      for(let ix=0; ix<d.items.length; ix++){
        const sel = document.querySelector(`input[name="q_${d.id}_${ix}"]:checked`);
        const v = sel ? parseInt(sel.value,10) : 0;
        sum += v;
        count += 1;
      }
      const max = count * 5;
      const val = max ? (sum / max) : 0;
      scores.push(val);
      raw.push(sum);
    }

    return { scores, raw };
  }

  function l2norm(vec){
    let s = 0;
    for(const x of vec) s += x*x;
    return Math.sqrt(s);
  }

  function cosineSimilarity(a, b){
    let dot = 0;
    for(let i=0;i<a.length;i++) dot += a[i]*b[i];
    const na = l2norm(a);
    const nb = l2norm(b);
    if(na === 0 || nb === 0) return 0;
    return dot / (na * nb);
  }

  function pickProfiles(vec){
    const ranked = TARGET_PROFILES.map(p => ({
      id:p.id,
      name:p.name,
      tagline:p.tagline,
      focus:p.focus,
      score: cosineSimilarity(vec, p.vector)
    })).sort((a,b) => b.score - a.score);
    return ranked;
  }

  function band01(x){
    if(x >= 0.75) return { t:"Ισχυρό", c:"var(--safe)" };
    if(x >= 0.55) return { t:"Λειτουργικό", c:"var(--warn)" };
    return { t:"Ευάλωτο", c:"var(--danger)" };
  }

  function practicalMeaning(dimId, score01){
    const b = band01(score01).t;
    const out = [];

    if(dimId === "init"){
      if(b === "Ισχυρό"){
        out.push("Η εκκίνηση γίνεται γρήγορα και ο ρυθμός κρατά.");
        out.push("Η αναβολή δεν κυριαρχεί στην εβδομάδα.");
      } else if(b === "Λειτουργικό"){
        out.push("Η εκκίνηση γίνεται, αλλά σε πίεση καθυστερεί.");
        out.push("Χρειάζεται πιο καθαρός κανόνας έναρξης.");
      } else {
        out.push("Η εκκίνηση καθυστερεί και ο χρόνος χάνεται πριν αρχίσει η δουλειά.");
        out.push("Χρειάζεται πρωτόκολλο έναρξης με μικρά βήματα.");
      }
    }

    if(dimId === "goals"){
      if(b === "Ισχυρό"){
        out.push("Οι στόχοι είναι καθαροί και γίνονται πράξη.");
        out.push("Υπάρχει προτεραιοποίηση και έλεγχος προόδου.");
      } else if(b === "Λειτουργικό"){
        out.push("Οι στόχοι υπάρχουν, αλλά μερικές φορές είναι πολλοί.");
        out.push("Χρειάζεται πιο καθαρό κλείσιμο και εβδομαδιαία ανασκόπηση.");
      } else {
        out.push("Η μέρα γεμίζει χωρίς καθαρό στόχο, άρα χάνεται η προσπάθεια.");
        out.push("Χρειάζεται στόχος σε μία πρόταση και μικροδεσμεύσεις.");
      }
    }

    if(dimId === "focus"){
      if(b === "Ισχυρό"){
        out.push("Η προσοχή κρατά και η επιστροφή μετά από διάσπαση είναι γρήγορη.");
        out.push("Η ολοκλήρωση tasks είναι πιο σταθερή.");
      } else if(b === "Λειτουργικό"){
        out.push("Η προσοχή δουλεύει, αλλά το περιβάλλον τη σπάει.");
        out.push("Χρειάζονται κανόνες για ειδοποιήσεις και blocks εστίασης.");
      } else {
        out.push("Η διάσπαση ρίχνει απόδοση και αυξάνει κόπωση.");
        out.push("Χρειάζεται δομή 25 λεπτών και καθαρά όρια οθόνης.");
      }
    }

    if(dimId === "er"){
      if(b === "Ισχυρό"){
        out.push("Η ένταση μετατρέπεται σε σχέδιο και πράξη.");
        out.push("Η αναπλαισίωση μειώνει την καταστροφολογία.");
      } else if(b === "Λειτουργικό"){
        out.push("Η ρύθμιση υπάρχει, αλλά σε αιχμές ανεβαίνει υπερένταση.");
        out.push("Χρειάζεται παύση πριν από αποφάσεις.");
      } else {
        out.push("Το συναίσθημα οδηγεί τη συμπεριφορά και ο στόχος χάνει θέση.");
        out.push("Χρειάζεται εκπαίδευση σε αναπλαισίωση και παύση.");
      }
    }

    if(dimId === "dt"){
      if(b === "Ισχυρό"){
        out.push("Η δυσφορία δεν μπλοκάρει την πράξη και η συνέπεια κρατά.");
        out.push("Η ευελιξία βοηθά να μένουν οι αξίες μπροστά.");
      } else if(b === "Λειτουργικό"){
        out.push("Υπάρχει αντοχή, αλλά σε σημεία μπαίνει αποφυγή.");
        out.push("Χρειάζονται μικρές εκθέσεις σε δύσκολα κομμάτια.");
      } else {
        out.push("Η δυσφορία οδηγεί σε αποφυγή και πέφτει ο ρυθμός.");
        out.push("Χρειάζεται πρωτόκολλο ανοχής δυσφορίας σε μικρά βήματα.");
      }
    }

    if(dimId === "ss"){
      if(b === "Ισχυρό"){
        out.push("Υπάρχει στήριξη που ρίχνει τον φόρτο και την ένταση.");
        out.push("Η σύνδεση λειτουργεί σαν προστατευτικός παράγοντας.");
      } else if(b === "Λειτουργικό"){
        out.push("Υπάρχει στήριξη, αλλά δεν ενεργοποιείται πάντα όταν χρειάζεται.");
        out.push("Χρειάζεται μικρή στρατηγική επικοινωνίας και επαφής.");
      } else {
        out.push("Η μοναξιά αυξάνει επιβάρυνση και καθυστέρηση.");
        out.push("Χρειάζεται χτίσιμο στήριξης και ασφαλών καναλιών βοήθειας.");
      }
    }

    if(dimId === "hs"){
      if(b === "Ισχυρό"){
        out.push("Η βοήθεια ζητείται έγκαιρα και με σωστό τρόπο.");
        out.push("Οι στρατηγικές μάθησης είναι ενεργητικές και με feedback.");
      } else if(b === "Λειτουργικό"){
        out.push("Οι στρατηγικές υπάρχουν, αλλά δεν εφαρμόζονται σταθερά σε πίεση.");
        out.push("Χρειάζεται πιο συστηματικό active recall και έλεγχος λαθών.");
      } else {
        out.push("Η βοήθεια ζητείται αργά ή καθόλου και τα κενά μεγαλώνουν.");
        out.push("Χρειάζεται script βοήθειας και εβδομαδιαίο πλάνο μάθησης.");
      }
    }

    if(dimId === "rec"){
      if(b === "Ισχυρό"){
        out.push("Η ανάκαμψη στηρίζει απόδοση και αντοχή.");
        out.push("Η αποφόρτιση κρατά σταθερό ρυθμό χωρίς εξάντληση.");
      } else if(b === "Λειτουργικό"){
        out.push("Η ανάκαμψη είναι μέτρια και σε φόρτο πέφτει.");
        out.push("Χρειάζεται προστασία ύπνου και αποσύνδεση πριν τη νύχτα.");
      } else {
        out.push("Ο ύπνος ή η αποφόρτιση είναι ασταθή και η κόπωση ανεβαίνει.");
        out.push("Χρειάζεται πρωτόκολλο ύπνου και όρια οθόνης.");
      }
    }

    return out.slice(0,2);
  }

  function renderProfile(meta, scores01, ranked){
    const best = ranked[0];
    const second = ranked[1];

    const badges = DIMENSIONS.map((d,i)=>{
      const pct = Math.round(scores01[i] * 100);
      const b = band01(scores01[i]);
      return `<span class="badge"><b style="color:${b.c};">${d.name}</b> ${pct}% ${b.t}</span>`;
    }).join("");

    const focusBullets = best.focus.map(x => `• ${x}`).join("<br/>");

    profileBox.innerHTML = `
      <div style="display:flex; gap:10px; flex-wrap:wrap; justify-content:space-between;">
        <div>
          <div style="font-weight:900; font-size:14px;">Κοντινότερο προφίλ</div>
          <div style="margin-top:6px; font-size:14px;"><b>${best.name}</b></div>
          <div class="hint" style="margin-top:6px;">${best.tagline}</div>
        </div>
        <div class="hint" style="max-width:320px;">
          Ομοιότητα μοτίβου. ${(best.score*100).toFixed(1)}%.<br/>
          Δεύτερο προφίλ. ${second ? second.name : "δεν υπάρχει"}.
        </div>
      </div>

      <div class="sep"></div>

      <div style="font-weight:900; font-size:13px;">Χάρτης δεξιοτήτων</div>
      <div class="badgeRow">${badges}</div>

      <div class="sep"></div>

      <div class="kpi">
        <div class="box">
          <b>Τι σημαίνει</b>
          <span>Το σχήμα δείχνει πού υπάρχει σταθερότητα και πού υπάρχει ευαλωτότητα.</span>
        </div>
        <div class="box">
          <b>Γιατί βοηθά</b>
          <span>Η στόχευση γίνεται σε συγκεκριμένες δεξιότητες, άρα μειώνεται ο θόρυβος.</span>
        </div>
        <div class="box">
          <b>Τι κάνεις μετά</b>
          <span>Στέλνεις την αναφορά και παίρνεις καθοδήγηση για πρακτικά βήματα.</span>
        </div>
      </div>

      <div class="sep"></div>

      <div style="font-weight:900; font-size:13px;">Προτεινόμενη εστίαση υποστήριξης</div>
      <div class="hint" style="margin-top:8px; line-height:1.55;">${focusBullets}</div>
    `;
  }

  function drawRadar(scores01){
    const ctx = radar.getContext("2d");
    const W = radar.width;
    const H = radar.height;
    ctx.clearRect(0,0,W,H);

    const cx = W/2;
    const cy = H/2 + 12;
    const n = DIMENSIONS.length;
    const R = Math.min(W,H) * 0.34;

    function polar(i, r){
      const ang = (-Math.PI/2) + (i*(2*Math.PI/n));
      return { x: cx + r*Math.cos(ang), y: cy + r*Math.sin(ang) };
    }

    ctx.strokeStyle = "rgba(255,255,255,.16)";
    ctx.lineWidth = 1;

    for(let k=1;k<=4;k++){
      const rr = R*(k/4);
      ctx.beginPath();
      for(let i=0;i<n;i++){
        const p = polar(i, rr);
        if(i===0) ctx.moveTo(p.x,p.y);
        else ctx.lineTo(p.x,p.y);
      }
      ctx.closePath();
      ctx.stroke();
    }

    for(let i=0;i<n;i++){
      const p = polar(i, R);
      ctx.beginPath();
      ctx.moveTo(cx,cy);
      ctx.lineTo(p.x,p.y);
      ctx.stroke();
    }

    ctx.fillStyle = "rgba(47,214,196,.20)";
    ctx.strokeStyle = "rgba(102,169,255,.92)";
    ctx.lineWidth = 2;

    ctx.beginPath();
    for(let i=0;i<n;i++){
      const p = polar(i, R*scores01[i]);
      if(i===0) ctx.moveTo(p.x,p.y);
      else ctx.lineTo(p.x,p.y);
    }
    ctx.closePath();
    ctx.fill();
    ctx.stroke();

    ctx.fillStyle = "rgba(238,245,255,.95)";
    ctx.font = "12px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial";
    for(let i=0;i<n;i++){
      const p = polar(i, R + 24);
      const label = DIMENSIONS[i].name;
      drawWrappedLabel(ctx, label, p.x, p.y, cx, cy, 160);
    }
  }

  function drawWrappedLabel(ctx, text, x, y, cx, cy, maxW){
    const words = text.split(" ");
    const lines = [];
    let line = "";
    for(const w of words){
      const test = line ? (line + " " + w) : w;
      if(ctx.measureText(test).width > maxW && line){
        lines.push(line);
        line = w;
      } else {
        line = test;
      }
    }
    if(line) lines.push(line);

    const dx = x - cx;
    ctx.textAlign = dx > 30 ? "left" : (dx < -30 ? "right" : "center");
    ctx.textBaseline = "middle";

    const limited = lines.slice(0,2);
    for(let i=0;i<limited.length;i++){
      ctx.fillText(limited[i], x, y + i*14);
    }
  }

  function radarToDataURL(){
    try{
      return radar.toDataURL("image/png");
    }catch(e){
      return "";
    }
  }

  function escapeHtml(s){
    return String(s||"")
      .replaceAll("&","&amp;")
      .replaceAll("<","&lt;")
      .replaceAll(">","&gt;")
      .replaceAll('"',"&quot;")
      .replaceAll("'","&#039;");
  }

  function buildReportDoc(meta, scores01, ranked){
    const best = ranked[0];

    const rows = DIMENSIONS.map((d,i)=>{
      const pct = Math.round(scores01[i] * 100);
      const b = band01(scores01[i]).t;
      const m = practicalMeaning(d.id, scores01[i]);
      return `
        <tr>
          <td style="padding:8px; border:1px solid #ddd;">
            <b>${escapeHtml(d.name)}</b><br/>
            <span style="color:#444;">${escapeHtml(d.desc)}</span>
          </td>
          <td style="padding:8px; border:1px solid #ddd; text-align:center;">${pct}%</td>
          <td style="padding:8px; border:1px solid #ddd;">${escapeHtml(b)}</td>
          <td style="padding:8px; border:1px solid #ddd;">
            1. ${escapeHtml(m[0])}<br/>
            2. ${escapeHtml(m[1])}
          </td>
        </tr>
      `;
    }).join("");

    const radarPng = radarToDataURL();

    const html = `
      <html>
      <head>
        <meta charset="utf-8">
        <title>Αναφορά Φοιτητικής Ολιστικής Συμπεριφορικής Υποστήριξης</title>
      </head>
      <body style="font-family:Arial; font-size:12pt; line-height:1.35; color:#111;">
        <h1 style="margin:0 0 8px;">Αναφορά Ολιστικού Προφίλ Φοιτητή ή Φοιτήτριας</h1>
        <p style="margin:0 0 10px;">Ημερομηνία. ${escapeHtml(meta.date)}</p>

        <h2 style="margin:18px 0 8px;">Σκοπός</h2>
        <p>Η αξιολόγηση χαρτογραφεί δεξιότητες που επηρεάζουν μελέτη, συγκέντρωση, ρύθμιση έντασης, αντοχή, στήριξη και ανάκαμψη.</p>
        <p>Η αξιολόγηση υποστηρίζει ολιστική συμπεριφορική υποστήριξη και στοχοθεσία.</p>
        <p>Η αξιολόγηση δεν αποτελεί ψυχιατρική ή ψυχοπαθολογική διάγνωση.</p>

        <h2 style="margin:18px 0 8px;">Στοιχεία</h2>
        <p>Ονοματεπώνυμο. ${escapeHtml(meta.name)}</p>
        <p>Email. ${escapeHtml(meta.email)}</p>
        <p>Τμήμα ή Σχολή. ${escapeHtml(meta.school)}</p>
        <p>Στόχος 4 εβδομάδων. ${escapeHtml(meta.goal)}</p>
        <p>Σημειώσεις. ${escapeHtml(meta.notes)}</p>

        <h2 style="margin:18px 0 8px;">Προφίλ</h2>
        <p><b>Κοντινότερο προφίλ.</b> ${escapeHtml(best.name)}. ${escapeHtml(best.tagline)}</p>
        <p><b>Ομοιότητα μοτίβου.</b> ${(ranked[0].score*100).toFixed(1)}%</p>

        <h2 style="margin:18px 0 8px;">Διάγραμμα αράχνη</h2>
        ${radarPng ? `<p><img src="${radarPng}" style="width:100%; max-width:650px; border:1px solid #ddd;"/></p>` : `<p>Το διάγραμμα δεν ήταν διαθέσιμο για ενσωμάτωση.</p>`}

        <h2 style="margin:18px 0 8px;">Αποτελέσματα ανά διάσταση</h2>
        <table style="width:100%; border-collapse:collapse;">
          <tr>
            <th style="text-align:left; padding:8px; border:1px solid #ddd;">Διάσταση</th>
            <th style="text-align:center; padding:8px; border:1px solid #ddd;">Ποσοστό</th>
            <th style="text-align:left; padding:8px; border:1px solid #ddd;">Επίπεδο</th>
            <th style="text-align:left; padding:8px; border:1px solid #ddd;">Πρακτική σημασία</th>
          </tr>
          ${rows}
        </table>

        <h2 style="margin:18px 0 8px;">Σημείωση ασφάλειας</h2>
        <p>Αν υπάρχουν ενδείξεις σοβαρής επιβάρυνσης ή κινδύνου, χρειάζεται άμεση κλινική εκτίμηση.</p>
      </body>
      </html>
    `;
    return html;
  }

  function downloadDoc(filename, htmlContent){
    const blob = new Blob([htmlContent], { type: "application/msword;charset=utf-8" });
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;
    a.download = filename;
    document.body.appendChild(a);
    a.click();
    a.remove();
    setTimeout(()=>URL.revokeObjectURL(url), 4000);
  }

  function openEmail(meta){
    const subject = encodeURIComponent("Υποβολή αναφοράς Φοιτητικής Ολιστικής Συμπεριφορικής Υποστήριξης");
    const body = encodeURIComponent(
      "Καλησπέρα.\n\n" +
      "Σας αποστέλλω την αναφορά Word από τη συμπλήρωση του ερωτηματολογίου.\n\n" +
      "Ονοματεπώνυμο: " + (meta.name||"") + "\n" +
      "Email: " + (meta.email||"") + "\n" +
      "Τμήμα ή Σχολή: " + (meta.school||"") + "\n" +
      "Στόχος 4 εβδομάδων: " + (meta.goal||"") + "\n\n" +
      "Παρακαλώ βρείτε επισυναπτόμενο το αρχείο.\n"
    );
    window.location.href = `mailto:${EMAIL_TO}?subject=${subject}&body=${body}`;
  }

  function ensureReadyForCompute(){
    if(!requireConsent()) return { ok:false };

    if(qCard.style.display === "none"){
      alert("Πρώτα πάτησε Ξεκίνα το ερωτηματολόγιο.");
      return { ok:false };
    }

    const missing = findFirstUnanswered();
    if(missing){
      alert("Υπάρχει τουλάχιστον μία ερώτηση χωρίς απάντηση. Θα μεταφερθείς στο πρώτο σημείο.");
      scrollToUnanswered(missing);
      return { ok:false, missing };
    }

    return { ok:true };
  }

  function computeAndShow(){
    const gate = ensureReadyForCompute();
    if(!gate.ok) return;

    const meta = getMeta();
    const { scores } = computeDimensionScores();

    const ranked = pickProfiles(scores);

    resultsCard.style.display = "block";
    renderProfile(meta, scores, ranked);
    drawRadar(scores);

    radarNote.textContent = "Το διάγραμμα ενσωματώνεται και στην αναφορά, ώστε να υπάρχει οπτική εικόνα προφίλ.";

    lastComputed = { meta, scores, ranked };

    resultsCard.scrollIntoView({ behavior:"smooth", block:"start" });
  }

  function scrollToTop(){
    window.scrollTo({ top: 0, behavior: "smooth" });
  }

  function saveProgress(){
    const payload = {};
    payload.meta = getMeta();
    payload.consent = $("consent").checked;

    payload.answers = {};
    for(const d of DIMENSIONS){
      for(let ix=0; ix<d.items.length; ix++){
        const name = `q_${d.id}_${ix}`;
        const sel = document.querySelector(`input[name="${name}"]:checked`);
        if(sel) payload.answers[name] = sel.value;
      }
    }

    localStorage.setItem("fobsu_progress_v1", JSON.stringify(payload));
    alert("Η πρόοδος αποθηκεύτηκε.");
  }

  function autosaveLight(){
    const payload = {};
    payload.meta = getMeta();
    payload.consent = $("consent").checked;
    payload.answers = {};
    for(const d of DIMENSIONS){
      for(let ix=0; ix<d.items.length; ix++){
        const name = `q_${d.id}_${ix}`;
        const sel = document.querySelector(`input[name="${name}"]:checked`);
        if(sel) payload.answers[name] = sel.value;
      }
    }
    localStorage.setItem("fobsu_progress_v1", JSON.stringify(payload));
  }

  function loadProgress(){
    const raw = localStorage.getItem("fobsu_progress_v1");
    if(!raw){
      alert("Δεν βρέθηκε αποθηκευμένη πρόοδος.");
      return;
    }

    const payload = JSON.parse(raw);

    $("name").value = payload.meta?.name || "";
    $("email").value = payload.meta?.email || "";
    $("school").value = payload.meta?.school || "";
    $("goal").value = payload.meta?.goal || "";
    $("notes").value = payload.meta?.notes || "";
    $("consent").checked = !!payload.consent;

    if(qCard.style.display === "none"){
      buildQuestionnaire();
      qCard.style.display = "block";
    }

    const answers = payload.answers || {};
    for(const [k,v] of Object.entries(answers)){
      const inp = document.querySelector(`input[name="${k}"][value="${v}"]`);
      if(inp) inp.checked = true;
    }

    updateProgress();
    alert("Η πρόοδος φορτώθηκε.");
  }

  function resetAll(){
    if(!confirm("Να γίνει καθαρισμός όλων;")) return;

    $("name").value = "";
    $("email").value = "";
    $("school").value = "";
    $("goal").value = "";
    $("notes").value = "";
    $("consent").checked = false;

    localStorage.removeItem("fobsu_progress_v1");

    qCard.style.display = "none";
    resultsCard.style.display = "none";
    sectionsEl.innerHTML = "";
    navMini.innerHTML = "";
    totalItems = 0;
    lastComputed = null;

    alert("Έγινε καθαρισμός.");
    scrollToTop();
  }

  startBtn.addEventListener("click", () => {
    if(!requireConsent()) return;
    buildQuestionnaire();
    qCard.style.display = "block";
    qCard.scrollIntoView({ behavior:"smooth", block:"start" });
  });

  calcBtn.addEventListener("click", computeAndShow);
  calcBtnTop.addEventListener("click", computeAndShow);

  finishBtn.addEventListener("click", () => {
    const gate = ensureReadyForCompute();
    if(!gate.ok) return;

    computeAndShow();
    if(!lastComputed) return;

    const docHtml = buildReportDoc(lastComputed.meta, lastComputed.scores, lastComputed.ranked);
    downloadDoc("αναφορά_φοιτητικής_υποστήριξης.doc", docHtml);

    alert("Ευχαριστούμε για την υποβολή. Επικοινωνείστε με τον Δρ Χιώνη παρακαλούμε.");
    openEmail(lastComputed.meta);
  });

  downloadBtn.addEventListener("click", () => {
    if(!lastComputed){
      computeAndShow();
      if(!lastComputed) return;
    }
    const docHtml = buildReportDoc(lastComputed.meta, lastComputed.scores, lastComputed.ranked);
    downloadDoc("αναφορά_φοιτητικής_υποστήριξης.doc", docHtml);
  });

  emailBtn.addEventListener("click", () => {
    if(!lastComputed){
      alert("Πρώτα υπολογισμός προφίλ.");
      return;
    }
    openEmail(lastComputed.meta);
  });

  toTopBtn.addEventListener("click", scrollToTop);

  saveBtn.addEventListener("click", saveProgress);
  loadBtn.addEventListener("click", loadProgress);
  resetBtn.addEventListener("click", resetAll);
</script>
</body>
</html>
```0